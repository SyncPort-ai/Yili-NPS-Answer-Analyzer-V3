# çŸ¥è¯†åº“ç®¡ç†æŒ‡å—

## ğŸ“ å­˜å‚¨ä½ç½®

### ä¸»è¦æ–‡ä»¶ä½ç½®
```
nps-report-analyzer/
â”œâ”€â”€ data/æ´å¯Ÿæ™ºèƒ½ä½“å“ç±»å“ç‰Œæ¸ é“æ¸…å•.json    # ğŸ”„ äº§å“ç›®å½• (å¯ç›´æ¥ç¼–è¾‘)
â”œâ”€â”€ nps_report_v2/data/knowledge_base.db    # ğŸ’¾ SQLiteçŸ¥è¯†åº“ (ç³»ç»Ÿç®¡ç†)
â””â”€â”€ modify_knowledge_example.py             # ğŸ› ï¸ ä¿®æ”¹ç¤ºä¾‹è„šæœ¬
```

## ğŸ› ï¸ ä¿®æ”¹æ–¹æ³•

### æ–¹æ³•1: ç›´æ¥ç¼–è¾‘JSONæ–‡ä»¶ â­ æ¨è
**æœ€ç®€å•çš„æ–¹å¼ï¼Œé€‚åˆå¤§éƒ¨åˆ†ä¿®æ”¹éœ€æ±‚**

1. **ç¼–è¾‘äº§å“ç›®å½•**
   ```bash
   # ç›´æ¥ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶
   vi data/æ´å¯Ÿæ™ºèƒ½ä½“å“ç±»å“ç‰Œæ¸ é“æ¸…å•.json
   ```

2. **ç³»ç»Ÿè‡ªåŠ¨åŒæ­¥**
   - ç³»ç»Ÿæ¯åˆ†é’Ÿæ£€æŸ¥æ–‡ä»¶å˜åŒ–
   - æ£€æµ‹åˆ°æ›´æ–°åè‡ªåŠ¨åŒæ­¥åˆ°çŸ¥è¯†åº“
   - æ— éœ€é‡å¯æœåŠ¡

3. **å¯ä¿®æ”¹çš„å†…å®¹**
   - æ·»åŠ /åˆ é™¤äº§å“å“ç‰Œ
   - ä¿®æ”¹äº‹ä¸šéƒ¨ä¿¡æ¯
   - æ›´æ–°æ¸ é“ä¿¡æ¯
   - è°ƒæ•´äº§å“åˆ†ç±»

### æ–¹æ³•2: ç¨‹åºåŒ–APIä¿®æ”¹
**é€‚åˆæ‰¹é‡ä¿®æ”¹å’Œè‡ªåŠ¨åŒ–åœºæ™¯**

```python
from nps_report_v2 import PersistentKnowledgeManager

# åˆå§‹åŒ–ç®¡ç†å™¨
km = PersistentKnowledgeManager()

# ä¿®æ”¹ä¸šåŠ¡è§„åˆ™
new_rules = {
    "nps_scoring_rules": {
        "excellent_threshold": 60,  # ä¼˜ç§€é˜ˆå€¼
        "industry_benchmark": 35    # è¡Œä¸šåŸºå‡†
    }
}

km.store_knowledge(
    key="business_rules",
    category="business_logic",
    content=new_rules
)
```

### æ–¹æ³•3: é€šè¿‡Webç•Œé¢ (æœªæ¥åŠŸèƒ½)
**è®¡åˆ’ä¸­çš„åŠŸèƒ½ï¼Œå°†æä¾›å›¾å½¢ç•Œé¢**

## ğŸ“‹ çŸ¥è¯†åº“ç»“æ„

### æ ¸å¿ƒçŸ¥è¯†é¡¹
| çŸ¥è¯†é¡¹ | ç±»åˆ« | æè¿° | ä¿®æ”¹æ–¹å¼ |
|--------|------|------|----------|
| `yili_product_catalog` | äº§å“ç›®å½• | ä¼Šåˆ©äº§å“å’Œäº‹ä¸šéƒ¨ä¿¡æ¯ | JSONæ–‡ä»¶ |
| `business_rules` | ä¸šåŠ¡è§„åˆ™ | NPSè¯„åˆ†æ ‡å‡†ã€è´¨é‡é˜ˆå€¼ | APIä¿®æ”¹ |
| `analysis_templates` | åˆ†ææ¨¡æ¿ | ä¸‰å¤§ä¸šåŠ¡åŸŸæ ‡ç­¾ä½“ç³» | APIä¿®æ”¹ |
| `product_mention_frequency` | åŠ¨æ€å­¦ä¹  | äº§å“æåŠé¢‘ç‡ç»Ÿè®¡ | è‡ªåŠ¨æ›´æ–° |
| `problem_patterns` | åŠ¨æ€å­¦ä¹  | é—®é¢˜æ¨¡å¼è¯†åˆ« | è‡ªåŠ¨æ›´æ–° |

### ä¸šåŠ¡åŸŸæ ‡ç­¾ä½“ç³»
```json
{
  "æ¦‚å¿µè®¾è®¡": [
    "åŸæ–™å¤©ç„¶", "å¥¶æºä¼˜è´¨", "ç›®æ ‡ç¾¤ä½“", "å¥åº·", "è¥å…»ä»·å€¼æ„ŸçŸ¥", 
    "é«˜ç«¯", "é«˜å“è´¨", "æ—¶å°šæ½®æµ", "å®‰å…¨ä¿¡èµ–", "ä»·æ ¼", "åŒ…è£…ç¾è§‚"
  ],
  "å£å‘³è®¾è®¡": [
    "å£å‘³", "é…¸å‘³", "ç”œå‘³", "å¥¶é¦™å‘³", "å£æ„Ÿ", "ç»†è…»åº¦", 
    "é¡ºæ»‘åº¦", "å±‚æ¬¡æ„Ÿ", "é†‡åšåº¦", "è¥å…»ä»·å€¼æ„ŸçŸ¥"
  ],
  "åŒ…è£…è®¾è®¡": [
    "å­—ä½“ç¾è§‚åº¦", "å›¾æ¡ˆç¾è§‚åº¦", "è‰²å½©ç¾è§‚åº¦", "æ•´ä½“ç¾è§‚åº¦",
    "ä¿¡æ¯ä¼ è¾¾", "å“ç‰Œè®¤çŸ¥", "äº§å“å°è±¡", "æƒ…æ„Ÿå…±é¸£"
  ]
}
```

## ğŸ”§ å¸¸ç”¨ä¿®æ”¹åœºæ™¯

### 1. æ·»åŠ æ–°äº§å“
**ç¼–è¾‘JSONæ–‡ä»¶ï¼Œåœ¨å¯¹åº”äº‹ä¸šéƒ¨æ·»åŠ :**
```json
{
  "brand_id": 100,
  "brand_name": "æ–°äº§å“åç§°",
  "category": "äº§å“ç±»åˆ«",
  "product_examples": "å…·ä½“äº§å“ç¤ºä¾‹",
  "channel_code": "YILI_APP_XX",
  "channel_name": "å¯¹åº”å°ç¨‹åºåç§°"
}
```

### 2. è°ƒæ•´NPSè¯„åˆ†æ ‡å‡†
**ä½¿ç”¨APIä¿®æ”¹:**
```python
km.store_knowledge("business_rules", "business_logic", {
    "nps_scoring_rules": {
        "promoter_range": [9, 10],
        "excellent_threshold": 50,  # è°ƒæ•´é˜ˆå€¼
        "industry_benchmark": 30    # è°ƒæ•´åŸºå‡†
    }
})
```

### 3. æ‰©å±•ä¸šåŠ¡æ ‡ç­¾
**æ·»åŠ æ–°çš„åˆ†ææ ‡ç­¾:**
```python
templates = km.get_knowledge("analysis_templates")
templates["business_domain_tags"]["æ¦‚å¿µè®¾è®¡"].extend([
    "å¯æŒç»­å‘å±•", "æ™ºèƒ½åŒ…è£…", "ä¸ªæ€§åŒ–å®šåˆ¶"
])
km.store_knowledge("analysis_templates", "analysis_templates", templates)
```

### 4. æŸ¥çœ‹çŸ¥è¯†åº“çŠ¶æ€
```python
from nps_report_v2 import AuxiliaryDataManager

aux = AuxiliaryDataManager()
summary = aux.get_knowledge_summary()
print(summary)
```

## ğŸ“Š ç›‘æ§å’Œå¤‡ä»½

### è‡ªåŠ¨ç›‘æ§
- ç³»ç»Ÿæ¯åˆ†é’Ÿæ£€æŸ¥æ–‡ä»¶å˜åŒ–
- è‡ªåŠ¨åŒæ­¥æ›´æ–°åˆ°çŸ¥è¯†åº“
- è®°å½•å˜æ›´å†å²å’Œç‰ˆæœ¬

### æ‰‹åŠ¨å¤‡ä»½
```python
# å¯¼å‡ºå®Œæ•´å¤‡ä»½
aux = AuxiliaryDataManager()
backup_path = aux.export_knowledge_backup()
print(f"å¤‡ä»½å·²ä¿å­˜åˆ°: {backup_path}")
```

### ç¼“å­˜ç®¡ç†
```python
# æ¸…ç©ºç¼“å­˜ï¼Œå¼ºåˆ¶é‡æ–°åŠ è½½
aux = AuxiliaryDataManager()
aux.clear_cache()
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **JSONæ ¼å¼**ï¼šç¡®ä¿ç¼–è¾‘åçš„JSONæ ¼å¼æ­£ç¡®
2. **ä¸­æ–‡ç¼–ç **ï¼šä½¿ç”¨UTF-8ç¼–ç ä¿å­˜æ–‡ä»¶
3. **å¤‡ä»½ä¹ æƒ¯**ï¼šé‡è¦ä¿®æ”¹å‰å…ˆå¯¼å‡ºå¤‡ä»½
4. **æµ‹è¯•éªŒè¯**ï¼šä¿®æ”¹åè¿è¡Œç³»ç»ŸéªŒè¯åŠŸèƒ½æ­£å¸¸
5. **ç‰ˆæœ¬æ§åˆ¶**ï¼šç³»ç»Ÿè‡ªåŠ¨è®°å½•ç‰ˆæœ¬ï¼Œä½†å»ºè®®å¤–éƒ¨ä¹Ÿåšç‰ˆæœ¬ç®¡ç†

## ğŸš€ å¿«é€Ÿå¼€å§‹

1. **æŸ¥çœ‹å½“å‰çŠ¶æ€**
   ```bash
   python modify_knowledge_example.py
   # é€‰æ‹©é€‰é¡¹4æŸ¥çœ‹çŠ¶æ€
   ```

2. **è¿›è¡Œç®€å•ä¿®æ”¹**
   ```bash
   # ç¼–è¾‘äº§å“ç›®å½•
   vi data/æ´å¯Ÿæ™ºèƒ½ä½“å“ç±»å“ç‰Œæ¸ é“æ¸…å•.json
   # ç³»ç»Ÿä¼šè‡ªåŠ¨åŒæ­¥
   ```

3. **éªŒè¯ä¿®æ”¹ç»“æœ**
   ```python
   from nps_report_v2 import AuxiliaryDataManager
   aux = AuxiliaryDataManager()
   print(aux.get_knowledge_summary())
   ```

ç°åœ¨æ‚¨å¯ä»¥è½»æ¾ç®¡ç†å’Œä¿®æ”¹ç³»ç»Ÿçš„è¾…åŠ©ä¿¡æ¯äº†ï¼