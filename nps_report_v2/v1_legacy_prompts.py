"""
V1 Prompts模块的完整副本 - 用于V2系统内部调用
保持与原始prompts.py完全一致的逻辑
重命名为v1_legacy_prompts.py避免混淆
"""
import pandas as pd


aspect_dict={
    '概念设计': '原料天然、奶源优质、目标群体、乳糖不耐、素食主义、健身、颗粒、蛋白、脂肪、0蔗糖、植物蛋白、植物、水果、口味口感、卡路里、益生菌、维生素、有机、功效性、独特性、接受度、高端、高品质、时尚潮流、天然无添加、年轻活力、安全信赖、营养价值感知、健康、专业先进、文案宣传、品牌关联、价格、容量、爱国、奥运、低碳环保、包装美观',
    '口味设计': '口味、酸味、甜味、奶香味、果味、苦味涩味、异味杂味、协调度、余味回味、口感、细腻度、顺滑度、清新度、浓稀度流动性、层次感、醇厚度、添加剂、颗粒口感、小料口感、营养价值感知',
    '包装设计': '字体美观度、字体大小、字体颜色、图案美观度、图案风格、色彩美观度、整体美观度、信息传达、文案内容、品牌认知、产品印象、情感共鸣、瓶体、瓶口瓶盖、配件、容量'
}

def prompt_create(question, theme, emotion, answers):
    # theme_emotion = f"{theme}_{emotion}"
    # sample = sample_dict[theme_emotion]
    theme_specific = f"对于这个新品的{theme}，你{emotion}的原因是什么？" if theme != "其他设计" else f"{question}"
    emotion_specific = f'只提炼{emotion}的点。' if theme != "其他设计" else ""
    aspect = f'<预设标签>：\n{aspect_dict[theme]}\n\n' if theme != "其他设计" else ""
    
    prompt = f"""作为伊利乳制品公司的资深市场分析师，你的任务是针对问卷题目"{theme_specific}"的多个消费者回答进行深入的观点提取与精准打标。这对公司的产品改进和市场策略至关重要。

要求：
1. 整体分析：将每个回答视为一个完整的观点单元，不要过度拆分。
2. 观点提炼：
    - {emotion_specific}
    - 要求语言极致精简。
    - 提炼核心主谓结构，可保留必要的宾语或关键修饰词。
    - 去除标点、程度词、非必要修饰词。
    - 确保明确突出。
3. 标签分配：
    - {'优先从<预设标签>中选择最贴合的标签。如果预设标签不足以准确描述，再' if theme != "其他设计" else ''}自主创建准确、简洁的标签。
    - 标签应精准反映观点的核心评价维度。
    - {'如果实在无法提取明确的观点或分配合适的标签，使用"（未知，未知）"' if theme != "其他设计" else '如果回答与问题无关或表意不清，使用"（未知，未知）"'}。
4. 多维度分析：如果一个回答包含多个不同维度的观点，请分别列出所有相关的标签和观点对。
5. 语境理解：{'考虑产品类型和消费者可能的关注点，合理推断隐含的评价维度' if theme != "其他设计" else '严格对照问题内容，确保提取的观点与问题相关'}。

输出格式：
- 使用数字编号标识每个回答。
- 每个回答的观点和标签对使用"（标签，观点）"的格式。
- 同一回答的多个观点用"|"分隔。
- 不同回答用换行符分隔。

示例输出格式：
1. （口感，燕麦颗粒大）|（品质，产品新鲜）
2. （营养价值，富含蛋白质）
3. （未知，未知）

请记住，你的分析将直接影响产品开发和市场策略，务必保持专业、准确和洞察力。

## 内容
{aspect}<回答>：
{answers}
"""
    return prompt


def create_prompt_title(theme,emotion,answer_list):
    answer_text = "；".join(answer_list)
    theme_specific = f'针对"对于这个新品的{theme}，你{emotion}的原因是什么？"的' if theme != "其他设计" else ""
    report_type = "新品测试报告" if theme != "其他设计" else "市场研究报告"
    
    prompt_title = f"""你是专业的市场研究人员。{theme_specific}多个回答，已经进行了分类，以下的回答来自同一分类(不同回答用；隔开）：
"{answer_text}"
请为这些回答概括一个主题，要求语言精炼重点明确，此主题将用于撰写{report_type}(请直接输出主题，不要输出其他内容，不需要标点）"""
    return prompt_title